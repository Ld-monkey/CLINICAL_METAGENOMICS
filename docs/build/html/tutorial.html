

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="fr" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="fr" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4. Tutoriel &mdash; Documentation CLINICAL METAGENOMICS 1.0.0</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/translations.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="prev" title="3. Quick Start" href="quick_start.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> CLINICAL METAGENOMICS
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation_conda_environnement.html">1. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">2. Vue d’ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">3. Quick Start</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. Tutoriel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#le-pretraitement-des-reads">4.1. Le prétraitement des reads</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#programme">4.1.1. Programme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#localisation">4.1.2. Localisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#les-outils-utilises">4.1.3. Les outils utilisés</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exemple-d-utilisation">4.1.4. Exemple d’utilisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#les-parametres">4.1.5. Les paramètres</a></li>
<li class="toctree-l3"><a class="reference internal" href="#les-fichiers-de-sorties">4.1.6. Les fichiers de sorties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#le-telechargement-de-la-base-de-donnees-fda-argos">4.2. Le téléchargement de la base de données FDA-ARGOS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">4.2.1. Programme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">4.2.2. Localisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">4.2.3. Exemple d’utilisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">4.2.4. Les paramètres</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">4.2.5. Les fichiers de sorties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#le-telechargement-de-la-base-de-donnees-mycocosm">4.3. Le téléchargement de la base de données Mycocosm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id6">4.3.1. Programme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">4.3.2. Localisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">4.3.3. Exemple d’utilisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dependances">4.3.4. Dépendances</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#le-telechargement-de-la-base-de-donnees-fungidb">4.4. Le téléchargement de la base de données FungiDB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">4.4.1. Programme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">4.4.2. Localisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">4.4.3. Exemple d’utilisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">4.4.4. Les paramètres</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">4.4.5. Les fichiers de sorties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#le-telechargement-de-la-base-de-donnees-refseq">4.5. Le téléchargement de la base de données RefSeq</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id14">4.5.1. Programme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id15">4.5.2. Localisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">4.5.3. Exemple d’utilisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id17">4.5.4. Les paramètres</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">4.5.5. Les fichiers de sorties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#l-indexation-d-une-base-de-donnees-avec-kraken-2">4.6. L’indexation d’une base de données avec Kraken 2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#la-theorie">4.6.1. La théorie</a></li>
<li class="toctree-l3"><a class="reference internal" href="#la-pratique">4.6.2. La pratique</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id19">4.6.3. Programme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id20">4.6.4. Localisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">4.6.5. Exemple d’utilisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id22">4.6.6. Les paramètres</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id23">4.6.7. Les fichiers de sorties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#classification-des-reads-avec-kraken-2">4.7. Classification des reads avec Kraken 2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id24">4.7.1. La théorie</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id25">4.7.2. La pratique</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id26">4.7.3. Programme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id27">4.7.4. Localisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id28">4.7.5. Exemple d’utilisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id29">4.7.6. Les paramètres</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id30">4.7.7. Les fichiers de sorties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#creation-d-une-base-de-donnees-avec-la-suite-blast">4.8. Création d’une base de données avec la suite BLAST+</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id31">4.8.1. Dépendances</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id32">4.8.2. Programme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id33">4.8.3. Localisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id34">4.8.4. Exemple d’utilisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id35">4.8.5. Les paramètres</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id36">4.8.6. Les fichiers de sorties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#classification-des-reads-avec-la-suite-blast">4.9. Classification des reads avec la suite BLAST+</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CLINICAL METAGENOMICS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">4. </span>Tutoriel</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tutorial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutoriel">
<h1><a class="toc-backref" href="#id37"><span class="section-number">4. </span>Tutoriel</a><a class="headerlink" href="#tutoriel" title="Lien permanent vers ce titre">¶</a></h1>
<p>Ci-dessous, vous pouvez trouver le tutoriel sur comment utiliser le pipeline de métagénomique clinique.</p>
<div class="contents topic" id="sommaire">
<p class="topic-title">Sommaire</p>
<ul class="simple">
<li><p><a class="reference internal" href="#tutoriel" id="id37">Tutoriel</a></p>
<ul>
<li><p><a class="reference internal" href="#le-pretraitement-des-reads" id="id38">Le prétraitement des reads</a></p></li>
<li><p><a class="reference internal" href="#le-telechargement-de-la-base-de-donnees-fda-argos" id="id39">Le téléchargement de la base de données FDA-ARGOS</a></p></li>
<li><p><a class="reference internal" href="#le-telechargement-de-la-base-de-donnees-mycocosm" id="id40">Le téléchargement de la base de données Mycocosm</a></p></li>
<li><p><a class="reference internal" href="#le-telechargement-de-la-base-de-donnees-fungidb" id="id41">Le téléchargement de la base de données FungiDB</a></p></li>
<li><p><a class="reference internal" href="#le-telechargement-de-la-base-de-donnees-refseq" id="id42">Le téléchargement de la base de données RefSeq</a></p></li>
<li><p><a class="reference internal" href="#l-indexation-d-une-base-de-donnees-avec-kraken-2" id="id43">L’indexation d’une base de données avec Kraken 2</a></p></li>
<li><p><a class="reference internal" href="#classification-des-reads-avec-kraken-2" id="id44">Classification des reads avec Kraken 2</a></p></li>
<li><p><a class="reference internal" href="#creation-d-une-base-de-donnees-avec-la-suite-blast" id="id45">Création d’une base de données avec la suite BLAST+</a></p></li>
<li><p><a class="reference internal" href="#classification-des-reads-avec-la-suite-blast" id="id46">Classification des reads avec la suite BLAST+</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="admonition warning" id="pre-processing">
<p class="admonition-title">Avertissement</p>
<p>Dans la majorité des programmes présentés dans les sessions suivantes, il est possible de consulter les paramètres précis d’un programme en ajoutant la commande <strong>-h</strong> pour <strong>help</strong> comme illustré ci-contre.</p>
</div>
<p>Pour appeler l’aide dans les programmes :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">programme</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<div class="section" id="le-pretraitement-des-reads">
<h2><a class="toc-backref" href="#id38"><span class="section-number">4.1. </span>Le prétraitement des reads</a><a class="headerlink" href="#le-pretraitement-des-reads" title="Lien permanent vers ce titre">¶</a></h2>
<p>L’exemple suivant nous montre comment utiliser les étapes de prétraitement.</p>
<div class="section" id="programme">
<h3><span class="section-number">4.1.1. </span>Programme<a class="headerlink" href="#programme" title="Lien permanent vers ce titre">¶</a></h3>
<p>Nom du programme:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">launch_reads_preprocess</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="localisation">
<h3><span class="section-number">4.1.2. </span>Localisation<a class="headerlink" href="#localisation" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>└── src
 ├── bash
 │   ├── launch_reads_preprocess.sh
</pre></div>
</div>
</div>
<div class="section" id="les-outils-utilises">
<h3><span class="section-number">4.1.3. </span>Les outils utilisés<a class="headerlink" href="#les-outils-utilises" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">Clumpify.sh</dt>
<dd class="field-odd"><p>Le script Clumpify.sh de l’aligneur BBMap permet d’identifier les séquences identiques en sortie de séquençage. Configuré avec le paramètre Dedupe le script clumpify, fait intervenir le logiciel Dedupe de la suite BBMap pour éliminer les reads dupliqués.</p>
</dd>
<dt class="field-even">Dedupe</dt>
<dd class="field-even"><p>Dedupe supprime les reads dupliqués.</p>
</dd>
<dt class="field-odd">Trimmomatic</dt>
<dd class="field-odd"><p>Trimmomatic permet de supprimer les reads de mauvaise qualité c’est-à-dire les reads qui ont un score phread (score de qualité) moyen d’au moins 20 et des reads de taille minimum de 50 nucléotides pour avoir assez d’information pour classifier les reads.</p>
</dd>
</dl>
</div>
<div class="section" id="exemple-d-utilisation">
<h3><span class="section-number">4.1.4. </span>Exemple d’utilisation<a class="headerlink" href="#exemple-d-utilisation" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bash src/bash/launch_reads_preprocess.sh <span class="se">\</span>
             -path_reads data/reads/PAIRED_SAMPLES_ADN_TEST/ <span class="se">\</span>
             -path_output results/trimmed_reads/trimmed_PAIRED_SAMPLES_ADN_TEST_reads_04_06_2020/ <span class="se">\</span>
             -threads <span class="m">28</span>
</pre></div>
</div>
<p>Dans cet exemple, nous indiquons le dossier contenant les reads et nous précisons le dossier de sortie pour lequel les reads sortiront traités et filtrés. Nous pouvons préciser le nombre de threads pour accélérer le traitement, ici le nombre de thread est à 28.</p>
</div>
<div class="section" id="les-parametres">
<h3><span class="section-number">4.1.5. </span>Les paramètres<a class="headerlink" href="#les-parametres" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">-path_reads</dt>
<dd class="field-odd"><p>(Input) Le chemin du dossier avec l’ensemble des reads.</p>
</dd>
<dt class="field-even">-path_outputs</dt>
<dd class="field-even"><p>(Output) Le chemin du dossier de sortie des reads pré-traités.</p>
</dd>
<dt class="field-odd">-threads</dt>
<dd class="field-odd"><p>(Input) Le nombre de thread (par défaut configuré à 1 thread).</p>
</dd>
<dt class="field-even">-force_remove</dt>
<dd class="field-even"><p>(optionnel) Par défaut la valeur est sur « yes » et permet de supprimer les fichiers intermédiaires. Pour ne pas supprimer les fichiers intermédiaires configurer le paramètre avec la valeur « no » comme avec l’exemple ci-contre :</p>
</dd>
</dl>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bash src/bash/launch_reads_preprocess.sh <span class="se">\</span>
             -path_reads data/reads/PAIRED_SAMPLES_ADN_TEST/ <span class="se">\</span>
             -path_output results/trimmed_reads/trimmed_PAIRED_SAMPLES_ADN_TEST_reads_04_06_2020/ <span class="se">\</span>
             -force_remove no <span class="se">\</span>
             -threads <span class="m">28</span>
</pre></div>
</div>
</div>
<div class="section" id="les-fichiers-de-sorties">
<h3><span class="section-number">4.1.6. </span>Les fichiers de sorties<a class="headerlink" href="#les-fichiers-de-sorties" title="Lien permanent vers ce titre">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>Avec l’outil Trimmomatic :</p></li>
</ul>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">name_of_read</span><span class="o">&gt;</span><span class="n">_trimmed</span><span class="o">.</span><span class="n">fastq</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<p><strong>&lt;name_of_read&gt;_trimmed.fastq.gz</strong> correspondent aux reads qui ont correctement répondu aux conditions de filtrage.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">name_of_read</span><span class="o">&gt;</span><span class="n">_unpair_trimmed_fastq</span><span class="o">.</span>
</pre></div>
</div>
<p><strong>&lt;name_of_read&gt;_unpair_trimmed_fastq.gz</strong> correspondent aux reads qui n’ont pas correctement répondu aux conditions de filtrage.</p>
<blockquote>
<div><ul class="simple">
<li><p>Avec l’outil Clumpify.sh et Dedupe:</p></li>
</ul>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">name_of_read</span><span class="o">&gt;</span><span class="n">_depupe</span><span class="o">.</span><span class="n">fastq</span> <span class="p">:</span>
</pre></div>
</div>
<p><strong>&lt;name_of_read&gt;_depupe.fastq</strong> est le résultat des outils Clumpify.sh et Dedupe pour les reads.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">name_of_read</span><span class="o">&gt;</span><span class="n">_info</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p><strong>&lt;name_of_read&gt;_info.txt</strong> contient le nombre de reads totaux.</p>
</div>
</div>
<div class="section" id="le-telechargement-de-la-base-de-donnees-fda-argos">
<span id="download-fda-argos"></span><h2><a class="toc-backref" href="#id39"><span class="section-number">4.2. </span>Le téléchargement de la base de données FDA-ARGOS</a><a class="headerlink" href="#le-telechargement-de-la-base-de-donnees-fda-argos" title="Lien permanent vers ce titre">¶</a></h2>
<p>La session suivante, nous montre comment télécharger la base de données FDA-ARGOS.</p>
<div class="section" id="id1">
<h3><span class="section-number">4.2.1. </span>Programme<a class="headerlink" href="#id1" title="Lien permanent vers ce titre">¶</a></h3>
<p>Nom du programme:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">download_fda_argos_assembly</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3><span class="section-number">4.2.2. </span>Localisation<a class="headerlink" href="#id2" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>└── src
 ├── download
 │   ├── download_fda_argos_assembly.sh
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3><span class="section-number">4.2.3. </span>Exemple d’utilisation<a class="headerlink" href="#id3" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bash src/download/download_fda_argos_assembly.sh <span class="se">\</span>
                 -assembly_xml data/assembly/assembly_fda_argos_ncbi_result.xml <span class="se">\</span>
                 -path_output data/raw_sequences/fda_argos_assembly_raw_sequences/
</pre></div>
</div>
<p>Dans cet exemple, nous téléchargeons les séquences assemblées de FDA-ARGOS à l’aide d’un fichier XML présent dans le dossier data/assembly/assembly_fda_argos_ncbi_result.xml de l’architecture du projet git et nous précisons le dossier de sortie qui contiendra toutes les séquences, ici nous voulons que les résultats se retrouvent dans le dossier data/raw_sequences/fda_argos_assembly_raw_sequences/ .</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Il serait intéressant d’ajouter une fonctionnalité au programme afin de télécharger le fichier XML automatiquement avec les requêtes de NCBI et ainsi avoir les dernières modifications et ajouts de la base de données FDA-ARGOS.</p>
</div>
</div>
<div class="section" id="id4">
<h3><span class="section-number">4.2.4. </span>Les paramètres<a class="headerlink" href="#id4" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">-assembly_xml</dt>
<dd class="field-odd"><p>(Input) récupère le fichier XML pour l’analyser.</p>
</dd>
<dt class="field-even">-path_output</dt>
<dd class="field-even"><p>(Output) le chemin du dossier de sortie des les séquences de FDA-ARGOS.</p>
</dd>
</dl>
</div>
<div class="section" id="id5">
<h3><span class="section-number">4.2.5. </span>Les fichiers de sorties<a class="headerlink" href="#id5" title="Lien permanent vers ce titre">¶</a></h3>
<p>L’ensemble des séquences assemblées de FDA-ARGOS vont être téléchargées exemple :</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>├── GCF_000626615.2_ASM62661v3_genomic.fna
├── GCF_000783435.2_ASM78343v2_genomic.fna
├── GCF_000783445.2_ASM78344v2_genomic.fna
├── GCF_000783455.2_ASM78345v2_genomic.fna
├── GCF_000783465.2_ASM78346v2_genomic.fna
├── ...
</pre></div>
</div>
</div>
</div>
<div class="section" id="le-telechargement-de-la-base-de-donnees-mycocosm">
<span id="download-mycocosm"></span><h2><a class="toc-backref" href="#id40"><span class="section-number">4.3. </span>Le téléchargement de la base de données Mycocosm</a><a class="headerlink" href="#le-telechargement-de-la-base-de-donnees-mycocosm" title="Lien permanent vers ce titre">¶</a></h2>
<p>La session suivante, nous montre comment télécharger la base de données Mycocosm.</p>
<div class="section" id="id6">
<h3><span class="section-number">4.3.1. </span>Programme<a class="headerlink" href="#id6" title="Lien permanent vers ce titre">¶</a></h3>
<p>Nom du programme:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">download_mycocosm_scaffolds</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h3><span class="section-number">4.3.2. </span>Localisation<a class="headerlink" href="#id7" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>└── src
 ├── download
 │   ├── download_mycocosm_scaffolds.sh
</pre></div>
</div>
<p>Pour pouvoir télécharger les séquences de Mycocosm, plusieurs étapes doivent être réalisées.</p>
<ol class="arabic simple">
<li><p>Créer un compte sur le site du JGI <em>Joint Genome Institure</em> <a class="reference external" href="https://contacts.jgi.doe.gov/registration/new">https://contacts.jgi.doe.gov/registration/new</a></p></li>
<li><p>Confirmer votre inscription par mail.</p></li>
<li><p>Exécuter le programme.</p></li>
</ol>
</div>
<div class="section" id="id8">
<h3><span class="section-number">4.3.3. </span>Exemple d’utilisation<a class="headerlink" href="#id8" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bash src/download/download_mycocosm_scaffolds.sh <span class="se">\</span>
                  -username mail@a.com<span class="se">\</span>
                  -password azerty <span class="se">\</span>
                  -path_output data/raw_sequences/mycoccosm_fungi_ncbi_scaffolds/
</pre></div>
</div>
<p>Dans cet exemple, nous téléchargeons les scaffolds de la base de données Mycocosm en indiquant notre adresse mail avec le mot de passe associé (l’adresse mail et le mot de passe sont donnés ici à titre d’exemple et ne sont pas utilisables). Nous indiquons ensuite le chemin de sortie avec le paramètre -path_output, ici les scaffolds iront dans le dossier de sortie data/raw_sequences/mycoccosm_fungi_ncbi_scaffolds/ .</p>
</div>
<div class="section" id="dependances">
<h3><span class="section-number">4.3.4. </span>Dépendances<a class="headerlink" href="#dependances" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le programme dépend de deux scripts Python :</p>
<p>Le premier script Python est :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">src</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">download_scaffold_mycocosm_jgi</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p><strong>download_scaffold_mycocosm_jgi.py</strong> va télécharger :</p>
<blockquote>
<div><ul class="simple">
<li><p>le cookie,</p></li>
<li><p>le fichier XML,</p></li>
<li><p>les séquences scaffolds,</p></li>
<li><p>et créer un fichier récapitulatif en format csv <em>(The comma-separated values)</em>.</p></li>
</ul>
</div></blockquote>
<p>Le second script Python est :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">src</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">jgi_id_to_ncbi_id_taxonomy</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p><strong>jgi_id_to_ncbi_id_taxonomy.py</strong> associe les identifiants taxonomiques utilisés par JGI dans les scaffold et convertis en identifiant taxonomique du NCBI.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Cette conversion est nécessaire, car elle permet l’indexation des bases de données avec le logiciel Kraken 2. Kraken 2 (utilisé dans la suite du tutoriel) utilise et la taxonomie de référence du NCBI et l’algorithme de k-mer pour classifier les reads rapidement (voir section.).</p>
</div>
</div>
</div>
<div class="section" id="le-telechargement-de-la-base-de-donnees-fungidb">
<span id="download-fungidb"></span><h2><a class="toc-backref" href="#id41"><span class="section-number">4.4. </span>Le téléchargement de la base de données FungiDB</a><a class="headerlink" href="#le-telechargement-de-la-base-de-donnees-fungidb" title="Lien permanent vers ce titre">¶</a></h2>
<p>La session suivante, nous montre comment télécharger la base de données FungiDB.</p>
<div class="section" id="id9">
<h3><span class="section-number">4.4.1. </span>Programme<a class="headerlink" href="#id9" title="Lien permanent vers ce titre">¶</a></h3>
<p>Nom du programme:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">download_fungi_database_release_3</span><span class="o">.</span><span class="mf">0.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h3><span class="section-number">4.4.2. </span>Localisation<a class="headerlink" href="#id10" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>└── src
 ├── download
 │   ├── download_fungi_database_release_3.0.sh
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h3><span class="section-number">4.4.3. </span>Exemple d’utilisation<a class="headerlink" href="#id11" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bash src/download/download_fungi_database_release_3.0.sh <span class="se">\</span>
                  -path_output data/raw_sequences/fungi_db_all_genomes_06_07_2020/
</pre></div>
</div>
<p>Dans cet exemple, nous téléchargeons la base de données FungiDB et nous précisons le dossier de sortie qui est data/raw_sequences/fungi_db_all_genomes_06_07_2020/ .</p>
</div>
<div class="section" id="id12">
<h3><span class="section-number">4.4.4. </span>Les paramètres<a class="headerlink" href="#id12" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">-path_output</dt>
<dd class="field-odd"><p>(Output) Le chemin du dossier de sortie des séquences de FungiDB.</p>
</dd>
</dl>
</div>
<div class="section" id="id13">
<h3><span class="section-number">4.4.5. </span>Les fichiers de sorties<a class="headerlink" href="#id13" title="Lien permanent vers ce titre">¶</a></h3>
<p>L’ensemble des séquences de FungiDB vont être téléchargées exemple :</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>├── FungiDB-3.0_Aaculeatus_ATCC16872_Genome.fasta
├── FungiDB-3.0_Acapsulatus_G186AR_Genome.fasta
├── FungiDB-3.0_Acapsulatus_NAm1_Genome.fasta
├── FungiDB-3.0_Acarbonarius_ITEM5010_Genome.fasta
├── FungiDB-3.0_Aclavatus_NRRL1_Genome.fasta
├── ...
</pre></div>
</div>
</div>
</div>
<div class="section" id="le-telechargement-de-la-base-de-donnees-refseq">
<span id="download-refseq"></span><h2><a class="toc-backref" href="#id42"><span class="section-number">4.5. </span>Le téléchargement de la base de données RefSeq</a><a class="headerlink" href="#le-telechargement-de-la-base-de-donnees-refseq" title="Lien permanent vers ce titre">¶</a></h2>
<p>La session suivante, nous montre comment télécharger la base de données RefSeq.</p>
<div class="section" id="id14">
<h3><span class="section-number">4.5.1. </span>Programme<a class="headerlink" href="#id14" title="Lien permanent vers ce titre">¶</a></h3>
<p>Nom du programme:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">download_refseq_sequences</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="id15">
<h3><span class="section-number">4.5.2. </span>Localisation<a class="headerlink" href="#id15" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>└── src
 ├── download
 │   ├── download_refseq_sequences.sh
</pre></div>
</div>
</div>
<div class="section" id="id16">
<h3><span class="section-number">4.5.3. </span>Exemple d’utilisation<a class="headerlink" href="#id16" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bash src/download/download_refseq_sequences.sh <span class="se">\</span>
     -type_db viral <span class="se">\</span>
     -type_sq genomic <span class="se">\</span>
     -path_output data/raw_sequences/refseq_viral/
</pre></div>
</div>
<p>Dans cet exemple, nous téléchargeons les séquences virales de la base de données RefSeq en précisant le type de la base de données qui est donc -type_db viral et quel type de séquence nous voulons entre le génome et/ou les protéines, ici nous choisissons le génome en indiquant -type_sq genomic. Les différentes séquences téléchargées iront dans le dossier de sortie data/raw_sequences/refseq_viral/.</p>
</div>
<div class="section" id="id17">
<h3><span class="section-number">4.5.4. </span>Les paramètres<a class="headerlink" href="#id17" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">-type_db</dt>
<dd class="field-odd"><p>(Input) quel type de librairie à télécharger.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>La liste de tous les organismes que l’on peut télécharger avec le programme ci-dessus :</p>
<ul class="simple">
<li><p>bacteria</p></li>
<li><p>viral</p></li>
<li><p>archaea</p></li>
<li><p>fungi</p></li>
<li><p>invertebrate</p></li>
<li><p>mitochondrion</p></li>
<li><p>plant</p></li>
<li><p>plasmid</p></li>
<li><p>plastid</p></li>
<li><p>protozoa</p></li>
<li><p>vertebrate_mammalian</p></li>
<li><p>human</p></li>
</ul>
</div>
<p>Avec le programme, nous pouvons télécharger plusieurs librairies à la fois, mais il faut ajouter des guillemets pour indiquer que l’on veut ajouter plusieurs paramètres comme illustrés dans l’exemple suivant :</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bash src/download/download_refseq_sequences.sh <span class="se">\</span>
        -type_db <span class="s2">&quot;viral bacteria&quot;</span> <span class="se">\</span>
        -type_sq <span class="s2">&quot;genomic protein&quot;</span> <span class="se">\</span>
        -path_output data/raw_sequences/refseq_viral_bacteria_genomics_proteins/
</pre></div>
</div>
<p>Dans cet exemple, nous téléchargeons les séquences génomiques et protéiques des virus et bactéries de la base de données RefSeq.</p>
<dl class="field-list simple">
<dt class="field-odd">-type_sq</dt>
<dd class="field-odd"><p>(Optionel) précise le type de séquence à télécharger. Le choix se limite aux protéines (protein) et/ou génomes (genomic). Par défaut, c’est le génome qui est téléchargé si cet argument n’est pas précisé.</p>
</dd>
<dt class="field-even">-path_output</dt>
<dd class="field-even"><p>(Output) le chemin du dossier de sortie des séquences de RefSeq.</p>
</dd>
</dl>
</div>
<div class="section" id="id18">
<h3><span class="section-number">4.5.5. </span>Les fichiers de sorties<a class="headerlink" href="#id18" title="Lien permanent vers ce titre">¶</a></h3>
<p>L’ensemble des séquences de RefSeq vont être téléchargées exemple :</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>.
├── viral.1.1.genomic.fna.gz
└── viral.2.1.genomic.fna.gz
</pre></div>
</div>
</div>
</div>
<div class="section" id="l-indexation-d-une-base-de-donnees-avec-kraken-2">
<span id="indexation-kraken2"></span><h2><a class="toc-backref" href="#id43"><span class="section-number">4.6. </span>L’indexation d’une base de données avec Kraken 2</a><a class="headerlink" href="#l-indexation-d-une-base-de-donnees-avec-kraken-2" title="Lien permanent vers ce titre">¶</a></h2>
<p>Le logiciel Kraken 2 propose :</p>
<ol class="arabic simple">
<li><p>l’indexation avec l’algorithme de k-mer d’une base de données,</p></li>
<li><p>la classification taxonomique des reads.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>L’étape d’indexation de la base de données est la plus coûteuse en ressources et en temps. Une fois construite, la base de données de Kraken 2 est conservée, et n’a besoin d’être reconstruite que si une mise à jour est nécessaire.</p>
</div>
<div class="section" id="la-theorie">
<h3><span class="section-number">4.6.1. </span>La théorie<a class="headerlink" href="#la-theorie" title="Lien permanent vers ce titre">¶</a></h3>
<a class="reference internal image-reference" href="_images/indexation_kraken_2.png"><img alt="Indexation des librairies de séquences avec Kraken 2" class="align-right" src="_images/indexation_kraken_2.png" style="width: 400px;" /></a>
<p>Schéma des étapes d’indexation d’une base de données avec le logiciel Kraken 2 (image par Zygnematophyce).</p>
<ol class="arabic simple">
<li><p>Une base de données est une librairie de génomes (étape 1) qui recense l’ensemble des séquences génomiques.</p></li>
<li><p>Pour indexer la base de données sélectionnée, l’algorithme de Kraken 2 va ensuite hacher (étape 2) chaque génome de la base de données en fragments appelés k-mers de 31 nucléotides.</p></li>
<li><p>Chaque k-mer est ajouté à la base de données et obtient un numéro d’identification taxonomique (étape 3). Si c’est un nouveau k-mer, l’identifiant taxonomique de l’espèce d‘où il provient lui est associé.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Si le k-mer est déjà présent dans la base de données, l’ancêtre commun le plus proche (LCA) des deux identifiants taxonomiques est utilisé pour identifier ce fragment.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">Voir aussi</p>
<p>Les informations sur les taxons sont obtenues à partir de la base de données taxonomique du NCBI.</p>
</div>
</div>
<div class="section" id="la-pratique">
<h3><span class="section-number">4.6.2. </span>La pratique<a class="headerlink" href="#la-pratique" title="Lien permanent vers ce titre">¶</a></h3>
<p>La session qui suit nous montre comment indexer la base de données avec l’algorithme de k-mer et l’outil Kraken 2.</p>
</div>
<div class="section" id="id19">
<h3><span class="section-number">4.6.3. </span>Programme<a class="headerlink" href="#id19" title="Lien permanent vers ce titre">¶</a></h3>
<p>Nom du programme:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">create_kraken_database</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="id20">
<h3><span class="section-number">4.6.4. </span>Localisation<a class="headerlink" href="#id20" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>└── src
 ├── bash
 │   ├── create_kraken_database.sh
</pre></div>
</div>
</div>
<div class="section" id="id21">
<h3><span class="section-number">4.6.5. </span>Exemple d’utilisation<a class="headerlink" href="#id21" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bash src/bash/create_kraken_database.sh <span class="se">\</span>
             -path_seq data/raw_sequences/fda_argos_raw_genomes_assembly_06_06_2020/ <span class="se">\</span>
             -path_db data/databases/kraken_2/fda_argos_with_none_library_kraken_database_07_06_2020/ <span class="se">\</span>
             -type_db none <span class="se">\</span>
             -threads <span class="m">30</span>
</pre></div>
</div>
<p>Dans cet exemple, nous créons une base de données indexée à partir d’une librairie de séquence. Ici, les séquences assemblées de la base de données FDA-ARGOS qui se trouvent dans data/raw_sequences/fda_argos_raw_genomes_assembly_06_06_2020/ est la librairie choisie (voir <a class="reference internal" href="#download-fda-argos"><span class="std std-ref">le téléchargement de la base de données FDA-ARGOS</span></a>). Ensuite, avec le paramètre -path_db nous précisons le chemin de sortie pour notre base de données indexée ici le chemin sera data/databases/kraken_2/fda_argos_with_none_library_kraken_database_07_06_2020/.</p>
<p>Le paramètre -type_db est le paramètre qui détermine le type de la base de données. Nous avons choisi de ne pas rajouter d’autre libraire à notre base de données notre type est donc « none ».</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Kraken 2 propose une multitude de librairies qui peuvent être rajoutées à notre base de données. La liste non exhaustive des possibilités :</p>
<ul class="simple">
<li><p>none : Paramètre qui empêche le téléchargement et l’installation d’une ou plusieurs bibliothèques de référence</p></li>
<li><p>bacteria : RefSeq génomes / protéines bactériens complets</p></li>
<li><p>viral : RefSeq génome / protéines virales complètes</p></li>
<li><p>human : génome / protéines humains GRCh38</p></li>
<li><p>fungi : RefSeq génomes / protéines fongiques complets</p></li>
<li><p>…</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">Voir aussi</p>
<p>Pour voir l’ensemble de la liste : <a class="reference external" href="https://github.com/DerrickWood/kraken2/wiki/Manual#custom-databases">https://github.com/DerrickWood/kraken2/wiki/Manual#custom-databases</a></p>
</div>
<p>Et enfin le nombre de threads pour accélérer le processus, ici le nombre de threads est à 30.</p>
</div>
<div class="section" id="id22">
<h3><span class="section-number">4.6.6. </span>Les paramètres<a class="headerlink" href="#id22" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">-path_seq</dt>
<dd class="field-odd"><p>(Input) Chemin du dossier de la librairie de séquences sous format fna ou fasta.</p>
</dd>
<dt class="field-even">-path_db</dt>
<dd class="field-even"><p>(Output) Chemin du dossier de sortie pour créer et indexer notre base de données.</p>
</dd>
<dt class="field-odd">-type_db</dt>
<dd class="field-odd"><p>(Input) quel type de librairie ajouter à notre base de données (choix : none, viral, fungi …).</p>
</dd>
<dt class="field-even">-threads</dt>
<dd class="field-even"><p>(Input) le nombre de threads pour indexer la base de données plus rapidement.</p>
</dd>
<dt class="field-odd">-taxonomy</dt>
<dd class="field-odd"><p>(Optional) Dossier contenant la taxonomie du NCBI téléchargée par Kraken 2.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Dans le cas où l’on a téléchargé la taxonomie du NCBI en dehors de Kraken 2, on peut préciser le paramètre -taxonomy. Par défaut, le script va télécharger la taxonomie du NCBI automatiquement si le paramètre n’est pas précisé.</p>
</div>
</div>
<div class="section" id="id23">
<h3><span class="section-number">4.6.7. </span>Les fichiers de sorties<a class="headerlink" href="#id23" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les fichiers de sorties sont les suivants :</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>hash.k2d</strong> : Les mappages de taxons.</p></li>
<li><p><strong>opts.k2d</strong> : Les options utilisées pour créer la base de données.</p></li>
<li><p><strong>taxo.k2d</strong> : Les informations taxonomiques utilisées pour créer la base de données.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Par défaut, le script supprime les fichiers intermédiaires.</p>
</div>
</div>
</div>
<div class="section" id="classification-des-reads-avec-kraken-2">
<span id="classification-kraken2"></span><h2><a class="toc-backref" href="#id44"><span class="section-number">4.7. </span>Classification des reads avec Kraken 2</a><a class="headerlink" href="#classification-des-reads-avec-kraken-2" title="Lien permanent vers ce titre">¶</a></h2>
<p>La session suivante nous montre comment classifier un échantillon de reads avec le logiciel Kraken 2.</p>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p>La classification des reads ne peut se faire sans une base de données de référence indexée par le logiciel Kraken 2 (voir <a class="reference internal" href="#indexation-kraken2"><span class="std std-ref">L’indexation d’une base de données avec Kraken 2</span></a>).</p>
</div>
<div class="section" id="id24">
<h3><span class="section-number">4.7.1. </span>La théorie<a class="headerlink" href="#id24" title="Lien permanent vers ce titre">¶</a></h3>
<a class="reference internal image-reference" href="_images/classification_kraken2.png"><img alt="Classification des reads avec Kraken 2" class="align-right" src="_images/classification_kraken2.png" style="width: 450px;" /></a>
<p>Schéma des étapes de l’identification taxonomique d’une séquence cible avec le logiciel Kraken 2 (image par Zygnematophyce).</p>
<p>Pour classer une séquence, la séquence cible est fragmentée en tous les k-mers possibles de 31 nucléotides (étape 1). Chaque k-mer de la séquence cible est confronté à une base de données indexée par Kraken 2 (voir <a class="reference internal" href="#indexation-kraken2"><span class="std std-ref">L’indexation d’une base de données avec Kraken 2</span></a>) par correspondance exacte de k-mers, et un identifiant taxonomique lui est assigné (étape 2).</p>
<p>Avec la liste complète des identifiants taxonomiques associés à un read, l’algorithme reproduit un arbre taxonomique où chaque nœud correspond à un identifiant taxonomique (étape 3). Dans l’arbre de classification, le nombre de k-mers mappés est comptabilisé et permet d’apporter du poids au nombre de k-mers dans la séquence associée au taxon du nœud de l’arbre (étape 4). La branche avec la somme la plus grande est choisie, et la feuille de cette branche (exemple le nœud à l’extrémité) est utilisée pour identifier le read.</p>
</div>
<div class="section" id="id25">
<h3><span class="section-number">4.7.2. </span>La pratique<a class="headerlink" href="#id25" title="Lien permanent vers ce titre">¶</a></h3>
<p>La session qui suit, nous montrent comment classifier des reads avec Kraken 2.</p>
</div>
<div class="section" id="id26">
<h3><span class="section-number">4.7.3. </span>Programme<a class="headerlink" href="#id26" title="Lien permanent vers ce titre">¶</a></h3>
<p>Nom du programme:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">classify_set_reads_kraken</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="id27">
<h3><span class="section-number">4.7.4. </span>Localisation<a class="headerlink" href="#id27" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>└── src
 ├── bash
 │   ├── classify_set_reads_kraken.sh
</pre></div>
</div>
</div>
<div class="section" id="id28">
<h3><span class="section-number">4.7.5. </span>Exemple d’utilisation<a class="headerlink" href="#id28" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bash src/bash/classify_set_reads_kraken.sh <span class="se">\</span>
             -path_reads results/trimmed_reads/trimmed_PAIRED_SAMPLES_ADN_TEST_reads_01_07_2020/ <span class="se">\</span>
             -path_db data/databases/kraken_2/fda_argos_with_none_library_kraken_database_07_06_2020/ <span class="se">\</span>
             -path_output results/classify_reads/trimmed_classify_fda_argos_with_none_library_02_07_2020/ <span class="se">\</span>
             -threads <span class="m">27</span>
</pre></div>
</div>
<p>Dans cet exemple, nous allons classifier les reads traités dans le contenus dans le dossier results/trimmed_reads/trimmed_PAIRED_SAMPLES_ADN_TEST_reads_01_07_2020/ .</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Une étape de prétraitement (pre-processing) est appliquée sur les reads en amont de cette étape de classification voir <a class="reference internal" href="#pre-processing"><span class="std std-ref">le prétraitement des reads</span></a>.</p>
</div>
<p>Nous indiquons quelle base de données de référence utiliser avec le paramètre -path_db qui se trouve être dans le dossier data/databases/kraken_2/fda_argos_with_none_library_kraken_database_07_06_2020/ .</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>L’indexation d’une base de données de référence est expliquée dans la session <a class="reference internal" href="#indexation-kraken2"><span class="std std-ref">l’indexation d’une base de données avec Kraken 2</span></a></p>
</div>
<p>Nous précisons le dossier de sortie dans lequel les résultats de classification pourront être déposés, ici nous choisissons results/classify_reads/trimmed_classify_fda_argos_with_none_library_02_07_2020/ .</p>
<p>Et enfin le nombre de threads pour accélérer le processus, ici le nombre de threads est à 27.</p>
</div>
<div class="section" id="id29">
<h3><span class="section-number">4.7.6. </span>Les paramètres<a class="headerlink" href="#id29" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">-path_reads</dt>
<dd class="field-odd"><p>(Input) Le chemin du dossier contenant les reads.</p>
</dd>
<dt class="field-even">-path_db</dt>
<dd class="field-even"><p>(Input) Le chemin du dossier qui contient la base de données indexée par Kraken 2.</p>
</dd>
<dt class="field-odd">-path_output</dt>
<dd class="field-odd"><p>(Output) le nom du dossier pour les sorties.</p>
</dd>
<dt class="field-even">-threads</dt>
<dd class="field-even"><p>(Input) le nombre de threads utilisé pour classifier les reads. Par défaut le nombre de threads est 8.</p>
</dd>
</dl>
</div>
<div class="section" id="id30">
<h3><span class="section-number">4.7.7. </span>Les fichiers de sorties<a class="headerlink" href="#id30" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les fichiers de sorties sont les suivants :</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>.clseqs.fastq</strong> : Les séquences classifiées.</p></li>
<li><p><strong>.unclseqs.fastq</strong> : Les séquences non classifiées.</p></li>
<li><p><strong>.report.txt</strong> : Format de rapport standard de Kraken 2 avec une ligne par taxon (délimité par des tabulations).</p></li>
<li><p><strong>.output.txt</strong> : Format de sortie standard de Kraken 2. Chaque séquence classée par Kraken 2 entraîne une seule ligne de sortie. Les lignes de sortie de Kraken 2 contiennent cinq champs séparés par des tabulations.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pour comprendre en détail comment est agencé le fichier de sortie <em>.output.txt</em> voir la documentation officielle : <a class="reference external" href="https://github.com/DerrickWood/kraken2/wiki/Manual#output-formats">https://github.com/DerrickWood/kraken2/wiki/Manual#output-formats</a> .</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pour comprendre en détail la composition du fichier de sortie <em>.report.txt</em> voir la documentation officielle : <a class="reference external" href="https://github.com/DerrickWood/kraken2/wiki/Manual#sample-report-output-format">https://github.com/DerrickWood/kraken2/wiki/Manual#sample-report-output-format</a> .</p>
</div>
</div>
</div>
<div class="section" id="creation-d-une-base-de-donnees-avec-la-suite-blast">
<span id="creation-database-blast"></span><h2><a class="toc-backref" href="#id45"><span class="section-number">4.8. </span>Création d’une base de données avec la suite BLAST+</a><a class="headerlink" href="#creation-d-une-base-de-donnees-avec-la-suite-blast" title="Lien permanent vers ce titre">¶</a></h2>
<p>La session suivante nous montre comment créer une base de données locale qui permettra d’utiliser en amont l’alignement de séquence par l’algorithme de BLAST.</p>
<div class="section" id="id31">
<h3><span class="section-number">4.8.1. </span>Dépendances<a class="headerlink" href="#id31" title="Lien permanent vers ce titre">¶</a></h3>
<p>Avec la suite BLAST + nous utilisons :</p>
<blockquote>
<div><ul class="simple">
<li><p>L’application <strong>makeblastdb</strong> qui produit une base de données locale adaptée à l’algorithme de BLAST.</p></li>
<li><p>L’application <strong>dustmasker</strong> qui identifie et masque les parties à faible complexité d’un génome.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Les séquences de faible complexité sont par exemple les séquences répétées « ACACACACACACACACACACACACACAC » connues pour se produire dans de nombreux organismes différents et moins instructifs dans les alignements. Enlever ces séquences aide à prévenir les faux positifs dans les résultats.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">Voir aussi</p>
<p>Pour comprendre rapidement l’utilisation de chaque application, voir <a class="reference external" href="https://www.ncbi.nlm.nih.gov/books/NBK279681/">https://www.ncbi.nlm.nih.gov/books/NBK279681/</a> .</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p>Pour l’instant, aucune implémentation n’a été faite au niveau de la création d’une base de données concernant les séquences protéiques ainsi que la suppression des séquences à faible complexité des protéines (par exemple avec le logiciel segmasker).</p>
</div>
</div>
<div class="section" id="id32">
<h3><span class="section-number">4.8.2. </span>Programme<a class="headerlink" href="#id32" title="Lien permanent vers ce titre">¶</a></h3>
<p>Nom du programme:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">create_blast_database</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="id33">
<h3><span class="section-number">4.8.3. </span>Localisation<a class="headerlink" href="#id33" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>└── src
 ├── bash
 │   ├── create_blast_database.sh
</pre></div>
</div>
</div>
<div class="section" id="id34">
<h3><span class="section-number">4.8.4. </span>Exemple d’utilisation<a class="headerlink" href="#id34" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bash src/bash/create_blast_database.sh <span class="se">\</span>
             -path_seq data/raw_sequences/refseq/bacteria/ <span class="se">\</span>
             -output_db data/databases/blast/refseq/
</pre></div>
</div>
<p>Dans cet exemple, nous créons une base de données adaptée à BLAST en indiquant les séquences que l’on veut ajouter à notre base de données. Ici les séquences à ajouter sont celles téléchargées avec la base de données RefSeq expliquée en détail dans la session <a class="reference internal" href="#download-refseq"><span class="std std-ref">le téléchargement de la base de données RefSeq</span></a> du tutoriel. Ensuite, avec le paramètre -output_db nous précisons le chemin de sortie pour notre base de données.</p>
</div>
<div class="section" id="id35">
<h3><span class="section-number">4.8.5. </span>Les paramètres<a class="headerlink" href="#id35" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">-path_seq</dt>
<dd class="field-odd"><p>(Input) Chemin du dossier de la librairie de séquences.</p>
</dd>
<dt class="field-even">-output_db</dt>
<dd class="field-even"><p>(Output) Chemin du dossier de sortie pour créer notre base de données.</p>
</dd>
<dt class="field-odd">-dustmasker</dt>
<dd class="field-odd"><p>(Optional) Paramètre optionnel qui permet de choisir l’application ou non de dustmasker sur notre génome. Par défaut, le paramètre est sur « yes ». Pour ne pas utiliser dustmasker et changer le paramètre par « no » comme illustré ci-dessous.</p>
</dd>
</dl>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bash src/bash/create_blast_database.sh <span class="se">\</span>
             -path_seq data/raw_sequences/refseq/bacteria/ <span class="se">\</span>
             -output_db data/databases/blast/refseq/ <span class="se">\</span>
             -dustmasker no
</pre></div>
</div>
<p>Ici, nous créons une base de données refseq adaptée à BLAST, mais sans utiliser <em>dustmasker</em> et donc sans supprimer les séquences à faible complexité dans notre base de données.</p>
<dl class="field-list simple">
<dt class="field-odd">-force_remove</dt>
<dd class="field-odd"><p>(Optional) Paramètre optionnel qui permet de ne pas supprimer les fichiers intermédiaires. Par défaut, le paramètre est sur « yes » et supprime les fichiers intermédiaires. Pour ne pas supprimer les fichiers intermédiaires, changez le param_tre par « no » comme illustré ci-dessous.</p>
</dd>
</dl>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bash src/bash/create_blast_database.sh <span class="se">\</span>
             -path_seq data/raw_sequences/refseq/bacteria/ <span class="se">\</span>
             -output_db data/databases/blast/refseq/ <span class="se">\</span>
             -dustmasker no
             -force_remove no
</pre></div>
</div>
<p>Ici, nous créons une base de données refseq adaptée à BLAST, mais sans utiliser <em>dustmasker</em> et sans supprimer les fichiers intermédiaires.</p>
</div>
<div class="section" id="id36">
<h3><span class="section-number">4.8.6. </span>Les fichiers de sorties<a class="headerlink" href="#id36" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les fichiers de sorties de la base de données sont par exemple :</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>.
├── makeblastdb.naa
├── makeblastdb.nab
├── makeblastdb.nac
├── makeblastdb.nhr
├── makeblastdb.nin
├── makeblastdb.nog
├── makeblastdb.nsd
├── makeblastdb.nsi
├── makeblastdb.nsq
└── README.txt
</pre></div>
</div>
</div>
</div>
<div class="section" id="classification-des-reads-avec-la-suite-blast">
<span id="classification-blast"></span><h2><a class="toc-backref" href="#id46"><span class="section-number">4.9. </span>Classification des reads avec la suite BLAST+</a><a class="headerlink" href="#classification-des-reads-avec-la-suite-blast" title="Lien permanent vers ce titre">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="quick_start.html" class="btn btn-neutral float-left" title="3. Quick Start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Zygnematophyce

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>